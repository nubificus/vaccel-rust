// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package vaccel.torch;

enum DataType {
	UNUSED = 0; // For vAccel value compatibility
	BYTE = 1;
	CHAR = 2;
	SHORT = 3;
	INT = 4;
	LONG = 5;
	HALF = 6;
	FLOAT = 7;
}

message Tensor {
	bytes data = 1;
	repeated int64 dims = 2;
	DataType type = 3;
}

message ModelLoadRequest {
	int64 session_id = 1;
	int64 model_id = 2;
}

message ModelRunRequest {
	int64 session_id = 1;
	int64 model_id = 2;

	optional bytes run_options = 3;
	repeated Tensor in_tensors = 4;
	uint64 nr_out_tensors = 5;
}

message ModelRunResponse {
	repeated Tensor out_tensors = 1;
}
